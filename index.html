<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Оплата через Kaspi Pay</title>
  </head>
  <body>
    <h1>Оплата через Kaspi Pay</h1>
    <label for="amount">Сумма оплаты:</label>
    <input type="number" id="amount" placeholder="Введите сумму" />
    <button onclick="generateQR()">оплатить</button>

    <h3>Отсканируйте QR-код для оплаты:</h3>
    <div id="qr-code">
      <!-- QR-код появится здесь -->
    </div>

    <script>
      function generateQR() {
        var amount = document.getElementById("amount").value;
        if (amount === "" || amount <= 0) {
          alert("Пожалуйста, введите правильную сумму.");
          return;
        }

        // Пример строки данных для QR-кода, который будет содержать сумму и URL для оплаты.
        // В реальной интеграции сюда будут добавлены данные из Kaspi Pay API.
        // var paymentData = "https://kaspi.kz/pay?amount=" + amount;
        var paymen = `https://mamyruly.github.io/q2/?amount=${amount}`;
        // Генерация QR-кода через внешний сервис.
        // var qrCodeUrl =
        //   "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=" +
        //   encodeURIComponent(paymen);
        var qrs =
          "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=" +
          encodeURIComponent(paymen);
        // Отображение QR-кода на странице.
        document.getElementById("qr-code").innerHTML =
          "<img src='" + qrs + "' alt='QR Code'>";
      }

      function updateAfterPalyment(amount) {
        document.getElementById(
          "qr-code"
        ).innerHTML = `Оплата успешно произведена! Сумма: ${amount}`;
      }

      window.addEventListener("message", function (event) {
        if (event.origin === "https://mamyruly.github.io") {
          const amount = event.data.amount;
          updateAfterPalyment(amount);
        }
      });
    </script>
  </body>
</html>
